$(when-requesting-help "Configure your PKI:")
env -S "\$(kwm context pki)" kwm script | bash
$(when-requesting-help "Configure your kubectl for cluster admin access:")
env -S "\$(kwm context root)" kwm script | bash
$(when-requesting-help "Configure your etcd nodes:")
env -S "\$(kwm context etcd)" kwm script | bash
$(when-requesting-help "Configure your controlplane nodes:")
env -S "\$(kwm context controlplane)" kwm script | bash
$(when-requesting-help "Confirm controlplane is running:")
kubectl get componentstatus
$(when-requesting-help "Configure your worker nodes:")
env -S "\$(kwm context worker)" kwm script | bash
$(when-requesting-help "Install a container networking plugin:")
env -S "\$(kwm context cni)" kwm manifest > cni.yml
kubectl apply -f cni.yml
$(when-requesting-help "HACK bounce containerd to pick up cni settings from above:")
kwm exec-all sudo systemctl restart containerd
$(when-requesting-help "Install kube-dns:")
env -S "\$(kwm context dns)" kwm manifest > kube-dns.yml
kubectl apply -f kube-dns.yml
