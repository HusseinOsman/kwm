$(if-help-requested "Configure your PKI:")
env -S "\$(kwm context pki)" kwm script | bash
$(if-help-requested "Configure your kubectl for cluster admin access:")
env -S "\$(kwm context kubectl-root)" kwm script | bash
$(if-help-requested "Configure your etcd nodes:")
env -S "\$(kwm context etcd)" kwm script | bash
$(if-help-requested "Configure your controlplane nodes:")
env -S "\$(kwm context controlplane)" kwm script | bash
$(if-help-requested "Confirm controlplane is running:")
kubectl get componentstatus
$(if-help-requested "Configure your worker nodes:")
env -S "\$(kwm context worker)" kwm script | bash
$(if-help-requested "Install a container networking plugin:")
env -S "\$(kwm context cni)" kwm manifest > cni.yml
kubectl apply -f cni.yml
$(if-help-requested "HACK bounce containerd to pick up cni settings from above:")
kwm exec-all sudo systemctl restart containerd
$(if-help-requested "Install kube-dns:")
env -S "\$(kwm context dns)" kwm manifest > kube-dns.yml
kubectl apply -f kube-dns.yml
